    <%- include('../partials/head'); %>
<style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
    
    body {
        font-family: 'Inter', sans-serif;
    }
    
    .form-container {
        box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
    }
    
    .input-field {
        transition: all 0.2s ease;
    }
    
    .input-field:focus {
        box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.2);
    }
    
    .error-message {
        animation: fadeIn 0.3s ease-out;
    }
    
    .password-toggle {
        transition: color 0.2s ease;
    }
    
    .password-toggle:hover {
        color: #1e40af;
    }
    
    .radio-option {
        transition: all 0.2s ease;
    }
    
    .radio-option:hover {
        transform: translateY(-1px);
    }
    
    .submit-btn {
        transition: all 0.2s ease;
        box-shadow: 0 4px 6px -1px rgba(37, 99, 235, 0.1), 0 2px 4px -1px rgba(37, 99, 235, 0.06);
    }
    
    .submit-btn:hover {
        transform: translateY(-1px);
        box-shadow: 0 10px 15px -3px rgba(37, 99, 235, 0.1), 0 4px 6px -2px rgba(37, 99, 235, 0.05);
    }
    
    .submit-btn:active {
        transform: translateY(0);
    }
    
    .link-underline {
        position: relative;
        display: inline-block;
    }
    
    .link-underline::after {
        content: '';
        position: absolute;
        width: 100%;
        transform: scaleX(0);
        height: 2px;
        bottom: 0;
        left: 0;
        background-color: #2563eb;
        transform-origin: bottom right;
        transition: transform 0.25s ease-out;
    }
    
    .link-underline:hover::after {
        transform: scaleX(1);
        transform-origin: bottom left;
    }
    
    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(-5px); }
        to { opacity: 1; transform: translateY(0); }
    }
    
    @keyframes fadeSlideIn {
        from { opacity: 0; transform: translateY(20px); }
        to { opacity: 1; transform: translateY(0); }
    }
    
    .animate-fade-slide {
        animation: fadeSlideIn 0.5s ease-out both;
    }
    
    .checkbox-container {
        transition: all 0.2s ease;
    }
    
    .checkbox-container:hover {
        transform: translateX(2px);
    }
    
    .terms-link {
        transition: all 0.2s ease;
    }
    
    .terms-link:hover {
        color: #1e40af;
    }
</style>
</head>

<body class="bg-gradient-to-br from-blue-50 to-gray-50">

<%- include('../partials/nav', { currentPage: '' , isLoggedIn: false }) %>

<% function getError(field) {
    return errors && errors.find(e => e.param === field)?.msg;
} %>

<div class="flex items-center justify-center min-h-[calc(100vh-64px)] px-4 py-8">
    <div class="bg-white form-container rounded-xl w-full max-w-md p-8 animate-fade-slide">
        
        <div class="text-center mb-8">
            <h2 class="text-3xl font-extrabold text-gray-900">Create an account</h2>
            <p class="mt-2 text-gray-600">Join our community today</p>
        </div>

        <% if (errors && errors.length) { %>
            <div class="mb-6 bg-red-50 border-l-4 border-red-500 p-4 rounded">
                <div class="flex">
                    <div class="flex-shrink-0">
                        <svg class="h-5 w-5 text-red-500" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd" />
                        </svg>
                    </div>
                    <div class="ml-3">
                        <h3 class="text-sm font-medium text-red-800">Error!</h3>
                        <div class="mt-2 text-sm text-red-700">
                            <ul class="list-disc pl-5 space-y-1">
                                <% errors.forEach(error => { %>
                                    <li><%= error %></li>
                                <% }) %>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        <% } %>

        <form action="/auth/signup" method="POST" class="space-y-6">
            
            <!-- Username -->
            <div>
                <label for="username" class="block text-sm font-medium text-gray-700 mb-1">Username</label>
                <div class="mt-1 relative rounded-md shadow-sm">
                    <input type="text" id="username" name="username" value="<%= oldInput.username %>"
                        placeholder="Enter your username" required
                        class="input-field w-full px-4 py-3 border <%= getError('username') ? 'border-red-300 text-red-900 placeholder-red-300  focus:border-red-500' : 'border-gray-300  focus:ring-blue-500 focus:border-blue-500' %> rounded-lg focus:outline-none">
                </div>
                <% if (getError('username')) { %>
                    <p class="mt-2 text-sm text-red-600 error-message"><%= getError('username') %></p>
                <% } %>
            </div>

            <!-- Email -->
            <div>
                <label for="email" class="block text-sm font-medium text-gray-700 mb-1">Email Address</label>
                <div class="mt-1 relative rounded-md shadow-sm">
                    <input type="email" id="email" name="email" value="<%= oldInput.email %>"
                        placeholder="Enter your email" required
                        class="input-field w-full px-4 py-3 border <%= getError('email') ? 'border-red-300 text-red-900 placeholder-red-300 focus:ring-red-500 focus:border-red-500' : 'border-gray-300 placeholder-gray-400 focus:ring-blue-500 focus:border-blue-500' %> rounded-lg focus:outline-none">
                </div>
                <% if (getError('email')) { %>
                    <p class="mt-2 text-sm text-red-600 error-message"><%= getError('email') %></p>
                <% } %>
            </div>

            <!-- Password -->
            <div>
                <label for="password" class="block text-sm font-medium text-gray-700 mb-1">Password</label>
                <div class="mt-1 relative rounded-md shadow-sm">
                    <input type="password" id="password" name="password" required
                        placeholder="Enter your password"
                        class="input-field w-full px-4 py-3 pr-10 border <%= getError('password') ? 'border-red-300 text-red-900 placeholder-red-300 focus:ring-red-500 focus:border-red-500' : 'border-gray-300 placeholder-gray-400 focus:ring-blue-500 focus:border-blue-500' %> rounded-lg focus:outline-none">
                    <button type="button" onclick="togglePassword('password', 'eyeOpen1', 'eyeClosed1')"
                        class="password-toggle absolute inset-y-0 right-0 flex items-center pr-3">
                        <svg id="eyeOpen1" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5"
                            fill="currentColor" viewBox="0 0 20 20">
                            <path d="M10 3C5 3 1.73 7.11.46 10c1.27 2.89 4.54 7 9.54 7s8.27-4.11 9.54-7C18.27 7.11 15 3 10 3zm0 11a4 4 0 110-8 4 4 0 010 8z" />
                            <path d="M10 7a3 3 0 100 6 3 3 0 000-6z" />
                        </svg>
                        <svg id="eyeClosed1" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 hidden"
                            fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd"
                                d="M3.707 2.293a1 1 0 010 1.414L2.414 5 4.3 6.886A9.972 9.972 0 001 10c1.27 2.89 4.54 7 9.54 7 1.56 0 3.04-.34 4.4-.96l2.35 2.35a1 1 0 001.414-1.414l-15-15a1 1 0 00-1.414 0zM7.56 10.146l1.41 1.41a3 3 0 004.19-4.19l1.41 1.41A4.978 4.978 0 0110 15a5 5 0 01-5-5c0-.63.12-1.23.34-1.77l2.22 2.22z"
                                clip-rule="evenodd" />
                        </svg>
                    </button>
                </div>
                <% if (getError('password')) { %>
                    <p class="mt-2 text-sm text-red-600 error-message"><%= getError('password') %></p>
                <% } else { %>
                    <p class="mt-2 text-xs text-gray-500">Password must be at least 7 characters long and contain a number, letter, and special character.</p>
                <% } %>
            </div>

            <!-- Confirm Password -->
            <div>
                <label for="confirm_password" class="block text-sm font-medium text-gray-700 mb-1">Confirm Password</label>
                <div class="mt-1 relative rounded-md shadow-sm">
                    <input type="password" id="confirm_password" name="confirm_password" required
                        placeholder="Confirm your password"
                        class="input-field w-full px-4 py-3 pr-10 border <%= getError('confirm_password') ? 'border-red-300 text-red-900 placeholder-red-300 focus:ring-red-500 focus:border-red-500' : 'border-gray-300 placeholder-gray-400 focus:ring-blue-500 focus:border-blue-500' %> rounded-lg focus:outline-none">
                    <button type="button" onclick="togglePassword('confirm_password', 'eyeOpen2', 'eyeClosed2')"
                        class="password-toggle absolute inset-y-0 right-0 flex items-center pr-3">
                        <svg id="eyeOpen2" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5"
                            fill="currentColor" viewBox="0 0 20 20">
                            <path d="M10 3C5 3 1.73 7.11.46 10c1.27 2.89 4.54 7 9.54 7s8.27-4.11 9.54-7C18.27 7.11 15 3 10 3zm0 11a4 4 0 110-8 4 4 0 010 8z" />
                            <path d="M10 7a3 3 0 100 6 3 3 0 000-6z" />
                        </svg>
                        <svg id="eyeClosed2" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 hidden"
                            fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd"
                                d="M3.707 2.293a1 1 0 010 1.414L2.414 5 4.3 6.886A9.972 9.972 0 001 10c1.27 2.89 4.54 7 9.54 7 1.56 0 3.04-.34 4.4-.96l2.35 2.35a1 1 0 001.414-1.414l-15-15a1 1 0 00-1.414 0zM7.56 10.146l1.41 1.41a3 3 0 004.19-4.19l1.41 1.41A4.978 4.978 0 0110 15a5 5 0 01-5-5c0-.63.12-1.23.34-1.77l2.22 2.22z"
                                clip-rule="evenodd" />
                        </svg>
                    </button>
                </div>
                <% if (getError('confirm_password')) { %>
                    <p class="mt-2 text-sm text-red-600 error-message"><%= getError('confirm_password') %></p>
                <% } %>
            </div>

            <!-- User Type -->
            <div>
                <p class="block text-sm font-medium text-gray-700 mb-3">I want to register as:</p>
                <div class="grid grid-cols-2 gap-3">
                    <label class="radio-option flex items-center justify-center p-3 border-2 border-gray-200 rounded-lg cursor-pointer <%= oldInput.userType === 'guest' ? 'border-blue-500 bg-blue-50' : '' %>">
                        <input type="radio" name="userType" value="guest"
                            class="h-4 w-4 text-blue-600 focus:ring-blue-500 mr-2" <%= oldInput.userType === 'guest' ? 'checked' : '' %>>
                        <span class="text-sm font-medium text-gray-700">Guest</span>
                    </label>
                    <label class="radio-option flex items-center justify-center p-3 border-2 border-gray-200 rounded-lg cursor-pointer <%= oldInput.userType === 'host' ? 'border-blue-500 bg-blue-50' : '' %>">
                        <input type="radio" name="userType" value="host"
                            class="h-4 w-4 text-blue-600 focus:ring-blue-500 mr-2" <%= oldInput.userType === 'host' ? 'checked' : '' %>>
                        <span class="text-sm font-medium text-gray-700">Host</span>
                    </label>
                </div>
                <% if (getError('userType')) { %>
                    <p class="mt-2 text-sm text-red-600 error-message"><%= getError('userType') %></p>
                <% } %>
            </div>

            <!-- Terms -->
            <div class="checkbox-container flex items-start">
                <div class="flex items-center h-5">
                    <input id="terms" name="terms" type="checkbox" 
                        class="focus:ring-blue-500 h-4 w-4 text-blue-600 border-gray-300 rounded">
                </div>
                <div class="ml-3 text-sm">
                    <label for="terms" class="font-medium text-gray-700">
                        I agree to the <a href="/terms" class="terms-link text-blue-600 hover:text-blue-800">terms and conditions</a>
                    </label>
                </div>
            </div>
            <% if (getError('terms')) { %>
                <p class="mt-2 text-sm text-red-600 error-message"><%= getError('terms') %></p>
            <% } %>

            <!-- Submit -->
            <div>
                <button type="submit"
                    class="submit-btn w-full flex justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                    Register
                </button>
            </div>
        </form>

        <!-- Login link -->
        <div class="mt-6 text-center text-sm">
            <p class="text-gray-600">
                Already have an account?
                <a href="/auth/login" class="link-underline font-medium text-blue-600 hover:text-blue-500">Log in</a>
            </p>
        </div>
    </div>
</div>

<script>
function togglePassword(inputId, eyeOpenId, eyeClosedId) {
    const input = document.getElementById(inputId);
    const eyeOpen = document.getElementById(eyeOpenId);
    const eyeClosed = document.getElementById(eyeClosedId);
    if (input.type === 'password') {
        input.type = 'text';
        eyeOpen.classList.add('hidden');
        eyeClosed.classList.remove('hidden');
    } else {
        input.type = 'password';
        eyeOpen.classList.remove('hidden');
        eyeClosed.classList.add('hidden');
    }
}
window.addEventListener('DOMContentLoaded', () => {
    const fields = [
        { input: 'password', eyeOpen: 'eyeOpen1', eyeClosed: 'eyeClosed1' },
        { input: 'confirm_password', eyeOpen: 'eyeOpen2', eyeClosed: 'eyeClosed2' }
    ];
    fields.forEach(({ input, eyeOpen, eyeClosed }) => {
        const el = document.getElementById(input);
        const openIcon = document.getElementById(eyeOpen);
        const closedIcon = document.getElementById(eyeClosed);
        if (el.type === 'password') {
            openIcon.classList.remove('hidden');
            closedIcon.classList.add('hidden');
        } else {
            openIcon.classList.add('hidden');
            closedIcon.classList.remove('hidden');
        }
    });
});
</script>

</body>
</html>